# アクティブコンテキスト

## 現在の作業フォーカス

現在のプロジェクトフェーズは、**基本実装段階**です。基本的なアプリケーション構造が実装され、主要な機能のモック実装が完了しています。ストレージレイヤーとネットワーク通信のモック実装から本格的な実装への移行が進行中です。

### 主な焦点領域

1. **iroh-docsの本格的な実装**: 現在はモック実装ですが、iroh-docsを使用した本格的な分散型データストレージを実装する必要があります。ストレージマネージャー、変更トラッカー、同期マネージャーなどの基本的なインフラストラクチャは実装済みです。
2. **iroh-gossipの本格的な実装**: 現在はモック実装ですが、iroh-gossipを使用した本格的なP2P通信を実装する必要があります。
3. **UIの改善**: 基本的なUIは実装されていますが、ユーザーエクスペリエンスの向上のために改善が必要です。
4. **テストの実装**: ユニットテスト、統合テスト、E2Eテストを実装する必要があります。テスト用の依存関係（tokio, mockall, test-log, env_logger）は追加済みです。
5. **パフォーマンスの最適化**: データ同期やP2P通信のパフォーマンスを最適化する必要があります。

## 最近の変更

1. **基本的なアプリケーション構造の実装**:
   - フロントエンド: React、TypeScript、Zustandを使用したUI実装
   - バックエンド: Tauriコマンドを使用したRust実装
   - データモデル: Zodスキーマを使用したデータモデル定義

2. **主要機能の実装**:
   - ユーザー認証: ユーザー作成、サインイン、ユーザーリスト取得
   - 投稿管理: 投稿作成、取得、検索
   - プロフィール管理: プロフィール取得、更新
   - フォロー機能: フォロー、アンフォロー

3. **ストレージとネットワークのモック実装**:
   - JSONファイルを使用したシンプルなストレージ
   - モックネットワークを使用したシンプルな通信

4. **ストレージ技術の変更**:
   - Automergeからiroh-docsへの移行を決定
   - iroh-docsはより効率的な同期プロトコルを提供し、iroh-gossipとiroh-blobsと統合されている
   - 移行作業を開始
   - ストレージマネージャー、変更トラッカー、同期マネージャーなどの基本的なインフラストラクチャを実装

5. **データモデルの実装**:
   - User, Postなどの基本的なデータモデルを実装
   - HasId, PostTraitなどのトレイトを定義
   - シリアライズ/デシリアライズのサポート

## 次のステップ

### 短期的なタスク（1-2週間）

1. **iroh-docsの実装**:
   - iroh-docsの依存関係の追加
   - モック実装から実際のiroh-docsへの移行
   - データモデルの適応
   - 既存のストレージマネージャーとの統合

2. **iroh-gossipの実装**:
   - iroh-gossipの依存関係の追加
   - P2P通信の実装
   - トピックベースのメッセージングの実装
   - 既存のネットワークモジュールとの統合

3. **テスト環境のセットアップ**:
   - Vitestの設定
   - 基本的なテストの実装
   - モックの活用

### 中期的なタスク（3-5週間）

1. **ユーザー認証とプロフィール管理の強化**
2. **投稿作成と表示機能の強化**
3. **タイムラインの最適化**
4. **P2P通信の最適化**
5. **フォロー/フォロワー機能の強化**

## アクティブな決定事項

1. **技術スタックの選択**:
   - フロントエンド: React、TypeScript、Vite、Zustand、TanStack Query
   - バックエンド: Tauri、Rust、iroh-docs、iroh-gossip、iroh-blobs
   - テスト: Vitest、Playwright、Mockall

2. **アーキテクチャの決定**:
   - クライアントサイドアプリケーション
   - 分散型P2Pネットワーク
   - ローカルファーストデータ管理
   - モジュール型サービス統合

3. **データモデルの設計**:
   - ユーザープロフィール
   - 投稿
   - フォロー関係
   - アプリケーション設定

4. **実装アプローチ**:
   - 段階的な実装（MVP→拡張機能→エコシステム拡大→スケーリング）
   - テスト駆動開発
   - モジュール化されたコードベース

5. **ストレージ技術の変更**:
   - Automergeからiroh-docsへの移行
   - より効率的な同期プロトコルの採用
   - iroh-gossipとiroh-blobsとの統合

## 現在の考慮事項

1. **パフォーマンス最適化**:
   - iroh-docsのデータ構造の最適化
   - P2P通信の効率化
   - リソース使用量の最適化
   - 変更トラッカーの効率的な実装

2. **セキュリティ考慮事項**:
   - ユーザーデータの保護
   - 通信の暗号化
   - 権限管理
   - 秘密鍵の安全な保存

3. **ユーザーエクスペリエンス**:
   - オンボーディングプロセスの設計
   - UIの使いやすさ
   - オフライン対応
   - エラーハンドリングの改善

4. **スケーラビリティ**:
   - 大規模データセットの処理
   - 多数のユーザーとの同期
   - リソース使用量の管理
   - 効率的なデータ同期メカニズム

5. **テスト戦略**:
   - ユニットテスト
   - 統合テスト
   - E2Eテスト
   - パフォーマンステスト
   - モックの活用

## オープンな質問

1. **iroh-docsのパフォーマンス**: 大規模データセットでのiroh-docsのパフォーマンスはどうか？特に多数のエントリーを持つドキュメントの同期パフォーマンスはどうか？
2. **iroh-gossipのスケーラビリティ**: 多数のユーザーがいる場合のiroh-gossipのスケーラビリティはどうか？トピックベースのメッセージングの効率はどうか？
3. **クロスプラットフォーム互換性**: 異なるプラットフォーム間での一貫したユーザーエクスペリエンスをどのように確保するか？特にTauriアプリケーションのプラットフォーム固有の挙動をどう扱うか？
4. **オフライン対応**: オフライン状態でのユーザーエクスペリエンスをどのように最適化するか？特に同期の競合解決をどのように実装するか？
5. **モデレーション**: 分散型システムでのコンテンツモデレーションをどのように実装するか？ユーザー主導のモデレーションメカニズムは可能か？
6. **テスト戦略**: 分散型システムのテストをどのように効果的に実装するか？特にP2P通信のテストをどのように行うか？